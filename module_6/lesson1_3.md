# Язык SQL

Чтобы обратиться к СУБД, нужно использовать специальный язык запросов SQL (Structured Query Language). Для всех СУБД SQL выглядит одинаково, поэтому выучив его единожды, можно обращаться к любым базам данных (вообще говоря, различия есть, но они довольно мелкие). Сейчас мы кратко пройдемся по основным возможностям SQL и перейдем к практике работы с базами данных на Python.

SQL записывается на английском языке, поэтому давайте переведем две таблицы из прошлого урока на английский язык:

- Таблица "Ученик" -> "student"
- Таблица "Класс" -> "class"

А теперь давайте напишем запрос, который выведет нам всех учеников.

`SELECT * FROM student;`

| id | name | class_id | birth_date |
| -- | --- | -------- | ------------- |
| 1 | Авдеев Антон Антонинович | 2 | 31.05.2008 |
| 2 | Сазонова Неолина Богдановна | 2 | 30.04.2008 |
| 3 | Капустина Винетта Созоновна | 2 | 29.03.2008 |
| 4 | Носкова Алла Ростиславовна | 3 | 28.06.2006 |
| 5 | Марков Оскар Викторович | 3 | 27.07.2006 |
| 6 | Тетерин Вениамин Антонович | 3 | 26.08.2006 |

Ключевое слово `SELECT` сообщает о том, что мы хотим получим данные, `*` говорит о том, что мы хотим получить все колонки, и после `FROM` указываем таблицу, из которой хотим получить данные.

Вместо `*` можно было записать конкретные столбцы. Например, так:

`SELECT (id, name, class_id) FROM student;`

И тогда выведется таблица:

| id | name | class_id |
| -- | --- | -------- |
| 1 | Авдеев Антон Антонинович | 2 |
| 2 | Сазонова Неолина Богдановна | 2 |
| 3 | Капустина Винетта Созоновна | 2 |
| 4 | Носкова Алла Ростиславовна | 3 |
| 5 | Марков Оскар Викторович | 3 |
| 6 | Тетерин Вениамин Антонович | 3 |

Если мы бы захотели найти учеников только из класса с `id` 2, то мы бы использовали конструкцию `WHERE`:

`SELECT (id, name, class_id) FROM student WHERE class_id=2`

| id | name | class_id |
| -- | --- | -------- |
| 1 | Авдеев Антон Антонинович | 2 |
| 2 | Сазонова Неолина Богдановна | 2 |
| 3 | Капустина Винетта Созоновна | 2 |

Как видим, люди из других классов в таблицу не попали.

Если мы хотим объединить две таблицы в одну, то можно использовать конструкцию `JOIN ... ON`

```sql
SELECT (student.id, student.name, class.name) FROM student
JOIN class ON class.id = student.class_id
```

| id | name | class_name |
| -- | --- | -------- |
| 1 | Авдеев Антон Антонинович | 7 "А" |
| 2 | Сазонова Неолина Богдановна | 7 "А" |
| 3 | Капустина Винетта Созоновна | 7 "А" |
| 4 | Носкова Алла Ростиславовна | 9 "Б" |
| 5 | Марков Оскар Викторович | 9 "Б" |
| 6 | Тетерин Вениамин Антонович | 9 "Б" |

В скобках после `SELECT` мы отобрали те столбцы из таблиц, которые нам нужны (например, нам здесь не нужна колонка `id` из таблицы с классами). После `JOIN` указываем таблицу, с которой хотим соединиться, а после `ON` нужно указать условие, по которому будут соединяться таблицы. В нашем случае мы соединяем таблицы по внешнему ключу `student.class_id` с первичным ключом `class.id`.

После выполнения `JOIN` формируется большая таблица, в которому входят столбцы и первой и второй таблицы, но как правило вся таблица нам не нужна, поэтому важно после `SELECT` указывать только те столбцы, которые нужны нам.

`JOIN` и `WHERE` можно комбинировать:

```sql
SELECT (student.id, student.name, class.name) FROM student
WHERE student.class_id = 2
JOIN class ON class.id = student.class_id
```

| id | name | class_name |
| -- | --- | -------- |
| 1 | Авдеев Антон Антонинович | 7 "А" |
| 2 | Сазонова Неолина Богдановна | 7 "А" |
| 3 | Капустина Винетта Созоновна | 7 "А" |

SQL - очень большая тема, по которой была написана не одна книга. Для желающих глубже разобраться с темой SQL-запросов оставляем материалы для самостоятельного изучения.

- [4 ноутбук из GitHub-репозитория](https://github.com/svkov/brunoyam-ds-online-notebooks/blob/main/notebooks/04-DataBase.ipynb)
- [Памятка по SQL](https://habr.com/ru/post/564390/)
- [Здесь можно поработать с тестовой базой данных](https://www.w3schools.com/sql/trysql.asp?filename=trysql_op_in)
- [Интерактивный тренажер по SQL](https://stepik.org/course/63054/promo)
- [Нормальные формы](https://habr.com/ru/post/254773/)
