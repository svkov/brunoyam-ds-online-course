# Видео по проверке гипотез

На практике чаще всего проверка статистических гипотез связана с АБ-тестированием. Давайте сначала разберемся, что это такое.

Как люди понимают, что какое-то изменение в приложении позволит улучшить какой-то показатель?

Например, давайте представим, что на сайте Бруноям хотят изменить описание курса по Data Science и посмотреть, повлияет ли это на количество заявок или нет. Как правильно поставить такой эксперимент?

Обычно делают две версии сайта - с старым описанием и с новым, и параллельно выдают половине пользователей одну версию сайта, а половине пользователей другую. Накопив нужное количество данных, они анализируются и делается вывод, какая же версия сайта лучше.

Давайте решим такую задачу при помощи статистики. В реальности такой эксперимент пока не проводился, поэтому давайте сгенерируем данные. Наши данные будут принадлежать биномиальному распределению, так как человек либо запишется на курс, либо нет. Допустим мы запустили АБ-тест на 1000 людях в контрольной и экспериментальной группе и получили вот такие данные.

Так как мы сами сгенерировали данные и задали у второй выборки параметр $p2$, то мы знаем, что различие между выборками на самом деле есть, но по гистограмме сложно однозначно об этом сказать.

Также данные не похожи на нормальные и их довольно мало, поэтому использовать t-критерий Стьюдента здесь может быть некорректно, поэтому для подстраховки давайте также будем использовать критерий Манна-Уитни, который также позволяет найти разницу в двух выборках.

Для работы критерия Манна-Уитни нам не нужно каких-то специальных условий, он работает практически для любых выборок, так как это непараметрический критерий, в отличие от t-критерия Стьюдента, однако он имеет меньшую мощность на нормальных выборках. Поэтому если вы видите, что ваша выборка нормально распределена, то нужно использовать критерий Стьюдента, в другом же случае лучше использовать критерий Манна-Уитни.

Давайте посчитаем критерий для наших двух выборок, pvalue маленький, значит с хорошим уровнем значимости мы можем сказать, что гипотеза успешно доказана.

Давайте теперь поменяем параметры и немного приблизим распределения. Что выдаст критерий в таком случае? В большинстве случаев тест будет давать ложно-отрицательный результат и мы будем совершать ошибку второго рода. Почему так произошло?

Дело в том, что для поиска маленьких изменений нам необходимы большие объемы выборок. Давайте увеличим количество пользователей до 300, и увидим опять хороший pvalue.

На практике, конечно, взять и увеличить количество пользователей в эксперименте в несколько раз не получится, поэтому аналитики заранее понимают сколько и каких данных потребуется, чтобы получить верный результат с заданной вероятностью. Для расчета размера выборок можно использовать различные калькуляторы.

[https://mindbox.ru/ab-test-calculator/](https://mindbox.ru/ab-test-calculator/)

Чаще всего такие калькуляторы используются маркетологами, поэтому вы будете видеть показатели типа click rate, которые считаются в процентах, нам это подходит.

В нашем примере исходное среднее значение 20%, а повысить прирост мы хотим на 1% с достоверностью 95%. Также здесь есть параметр "Мощность", который отвечает за то, в скольки процентов случаев мы верно примем альтернативную гипотезу. Обычно этот параметр устанавливают на 80%. В литературе обычно этот параметр обозначают $\beta$, а 1-бета - вероятность ошибки второго рода.

Если указать эти параметры в калькулятор, то мы получим значение 25 117 на каждую группу, проверим результат. Действительно, pvalue меньше, чем порог, однако если провести такой эксперимент много раз, то в 20% случаев результат будет не тот, который мы ожидаем.

Действительно, на 1000 наблюдений мы получим только ... положительных результатов, что соответствует мощности критерия, который мы задавали.

Итак, давайте закрепим как провести АБ-тест и проверить гипотезу.

Во-первых, гипотезу нужно сформулировать, определиться с тем и какой результат она должна принести. Чем меньше ожидаемый результат, тем больше выборка потребуется. Затем мы оцениваем сколько данных нам потребуется и собираем эти данные.

Собрав данные, мы можем их проанализировать, применив нужный статистический критерий, и принять решение, какой вариант сайта оставить в продакшене.
