# Урок 2. Матрицы

## Что такое матрица

Мы уже поговорили о том, что данные можно представлять в виде векторов. Если мы запишем несколько векторов рядом, то получим матрицу.

Матрица - таблица чисел. У матрицы есть какое-то количество строк и столбцов. Обычно ее обозначают заглавной латинской буквой. Например, так:

$$
A = \begin{bmatrix}
1 & 2 & 3\\
4 & 5 & 6
\end{bmatrix}
$$

У матрицы $A$ 2 строки и 3 столбца, поэтому говорят, что ее размерность $2 \times 3$.

По аналогии с векторами, матрицы можно складывать и умножать на число. Это делается точно также, покомпонентно. **Важно:** мы можем складывать только матрицы одинаковой размерности.

Например, возьмем вторую матрицу:

$$
B = \begin{bmatrix}
7 & 8 & 9 \\
0 & 1 & 2
\end{bmatrix}
$$

Тогда сумма $A+B$ будет равна:

$$
A + B = \begin{bmatrix}
7 + 1 & 8 + 2 & 9 + 3 \\
0 + 4 & 1 + 5 & 2 + 6
\end{bmatrix} =
\begin{bmatrix}
8 & 10 & 12 \\
4 & 6 & 8
\end{bmatrix}
$$

## Произведение матриц

Важной операцией над матрицами является произведение. Оно определяется немного сложнее умножения и на то есть свои причины. Давайте посмотрим на реальную задачу, которую можно решить при помощи произведения матриц.

Вспомним наше приложение для знакомств. У нас было три фактора, которые мы использовали для оценки совместимости. Вообще говоря, эти факторы могут быть неравнозначными для разных людей. Например, человек, который любит животных, наверное, будет хотеть, чтобы его партнер любил животных, и мы бы хотели отмечать это как плюс. А если человек не интересуется астрологией, то ему все равно, нравится ли астрология его партнеру.

Давайте присвоим вес каждому признаку. Например, вспомним Иру и ее вектор:

$$Ира = (8, 9, 7)$$

Мы спросили насколько Ире важно каждое из качеств в ее партнере и получили вот такую картину:

$$Ира_w = (0.1, 0.9, 0.5)$$

Теперь если мы возьмем каждый из весов и умножим на соответствующий компонент вектора потенциального партнера, то получим взвешенный результат. Если затем сложить эти числа, то получим итоговую оценку. По сути, это будет скалярным произведением.

$$(Ира_w, Игорь) = ((0.1, 0.9, 0.5), (4, 0, 3)) = 1.9$$

Но что делать, если мы хотим взвесить для Иры 1000 кандидатов, чтобы отобрать наиболее подходящих? Тогда мы можем воспользоваться произведением вектора на матрицу. Пусть $A$ матриц размерности $3 \times 1000$. Каждый столбец - отдельный кандидат с тремя значениями параметров. А каждая строка - значения этого параметра у каждого из кандидатов. Запишем произведение:

$$Ира_w * A$$

Вектор слева мы скалярно умножили на каждый столбец матрицы справа и получили взвешенную оценку для каждого кандидата. Давайте посмотрим на примере поменьше как в деталях работает умножение.

Пусть,

$$
B = \begin{bmatrix}
1 & 2 \\
4 & 5 \\
8 & 9
\end{bmatrix}
$$

Тогда

$$Ира_w * B =
\begin{bmatrix}
1 * 0.1 + 4 * 0.9 + 8 * 0.5 \\
2 * 0.1 + 5 * 0.9 + 9 * 0.5
\end{bmatrix}
=
\begin{bmatrix}
7.7 \\
9.2
\end{bmatrix}
$$

А теперь давайте представим, что помимо Иры у нас есть еще несколько девушек, которые также указали вес каждого из параметров. Тогда вектор слева превратится в матрицу (она будет состоять из векторов-строк - ответов девушек). Если мы захотим для каждого вектора-строки из матрицы слева посчитать скалярное произведение с каждым вектором-столбцом в матрице справа, то мы как раз столкнемся с произведением двух матриц.

Давайте к предыдущем примеру добавим еще один вектор $(0.3, 0.5, 0.1)$, который вместе с $Ира_w$ будет формировать матрицу $W$ и посчитаем произведение матриц:

$$W * B =
\begin{bmatrix}
0.1 & 0.9 & 0.5 \\
0.3 & 0.5 & 0.1
\end{bmatrix}
*
\begin{bmatrix}
1 & 2 \\
4 & 5 \\
8 & 9
\end{bmatrix}
=
\begin{bmatrix}
0.1 * 1 + 0.9 * 4 + 0.5 * 8 & 0.1 * 2 + 0.9 * 5 + 0.5 * 9 \\
0.3 * 1 + 0.5  * 4 + 0.1 * 8 & 0.3 * 2 + 0.5 * 5 + 0.1 * 9
\end{bmatrix}
=
\begin{bmatrix}
7.7 & 9.2 \\
3.1 & 4.0
\end{bmatrix}
$$

Прежде чем перейти к анализу результатов, давайте посмотрим на размерности исходных матриц и итоговую.

$$(2 \times 3) * (3 \times 2) = (2 \times 2)$$

В общем случае это можно записать так

$$(n \times k) * (k \times m) = (n \times m)$$

Если у матрицы слева не совпадает количество столбцов с количеством строк матрицы справа, перемножать их нельзя.

Итак, к результатам. Мы получили матрицы, у которой в строках записана оценка кандидата для конкретного вектора из матрицы слева. Если мы захотим найти лучшего кандидата для этой девушки, то найдем максимум в этой строке. Если же мы захотим найти лучшую девушку для молодого человека, то мы возьмем максимум в соответствующем столбце.

## Еще несколько операций над матрицами

Есть еще несколько простых операций над матрицами.

### Единичная матрица

Иногда полезно иметь такую матрицу, умножение на которую ничего не сделает с исходной матрицей:

$$A * E = A$$

Обычно предполагается, что матрица $A$ - квадратная.

Тогда матрица $E$ может выглядеть так для случая $3 \times 3$:

$$
E = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

Для других размерностей она будет выглядеть точно также - на главной диагонали будут единицы, в остальных местах нули.

### Обратная матрица

Умножение на такую матрицу даст единичную:

$$A * A^{-1} = E$$

Поиск такой матрицы - нетривиальная задача. Важно знать, что существует алгоритм для поиска такой матрицы. Поиск обратной матрицы - трудоемкая операция, поэтому по возможности нужно избегать ее.

### Транспонирование матриц

Транспонирование матриц меняет местами строки таблицы с ее столбцами и позволяет перейти от матрицы размерности $m \times n$ к размерности $n \times m$. Может быть полезно, когда нужно перемножить две матрицы, но одна из них находится не в том формате.

Обозначение: $A^T$

### Определитель матрицы

Для решения задач нам понадобится понятие **определителя матрицы**. Определитель матрицы - это величина, которая показывает насколько вектор будет увеличен или уменьшен после умножения на матрицу. Определение у этого понятия довольно сложное и неинтуитивное, поэтому мы запомним только его обозначение:

$$|A|$$

или

$$det(A)$$

Определитель часто встречается при решении задач. Как его посчитать для небольших матриц [можно прочитать, например, здесь](http://mathprofi.ru/kak_vychislit_opredelitel.html)

## Полезные ссылки

- [Видео с красивой визуализацией линейной алгебры](https://www.youtube.com/playlist?list=PLVjLpKXnAGLXPaS7FRBjd5yZeXwJxZil2)
