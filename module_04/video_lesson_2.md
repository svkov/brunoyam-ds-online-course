# Задачи на умножение матриц

Умножение матриц обычно используется как промежуточный результат для решения задачи и иногда появляется в неожиданных местах. Давайте решим задачу, в которой естественным образом появляется умножение матриц.

## Задача 1

В торговой сети "Березка" в разных городах стоимость товара различается, но ассортимент один и тот же. Ассортимент пронумерован от 1 до $n$, а города от 1 до $m$. Стоимость товара задается таблицей $A$, а элемент на позиции $i, j$ означает стоимость товара j в городе i.

Например, если таблица A состоит из 2 строк и 3 столбцов, это означает, что в магазине продается 3 товара, а магазин присутствует в двух городах, и нам известна стоимость каждого товара. Матрица A:

$$
A = \begin{bmatrix}
4 & 3 & 10 \\
5 & 4 & 11
\end{bmatrix}
$$

Раз в несколько дней магазин производит закупку товара у поставщика. Объем поставок записывается в таблице B. Элемент на позиции $i, j$ означает, что в город $i$ товар $j$ поступит в объеме $b_{ij}$. Матрица B:

$$
B = \begin{bmatrix}
5 & 0 & 5 \\
4 & 1 & 3
\end{bmatrix}
$$

Сколько заработает магазин, если продаст весь заказанный товар?

## Решение

Для решения задачи необходимо умножить матрицы A и B. Но давайте сначала посмотрим на размерности матриц.

Обе матрицы имеют размерность $(n, m)$, а мы помним, что мы можем умножать матрицы только когда количество столбцов левой матрицы совпадает с количеством строк правой матрицы. Значит, нам нужно как-то преобразовать одну из матриц.

Конечно же, мы можем транспонировать одну из матриц. Например, транспонируем матрицу $B$, умножим матрицу А на нее и будем обозначать этот результат как матрицу $C$:

$$С = AB^T$$

Тогда размерности будут $(n, m) * (m, n)$ и в ответе мы получим матрицу размерности $(n, n)$.

Что будут означать значения внутри этой матрицы? Давайте посмотрим на примере нашей матрицы:

$$
AB^T = \begin{bmatrix}
70 & 49 \\
80 & 57
\end{bmatrix} = C
$$

Значение в ячейке $c_{ij}$ означает за сколько бы мы продали объем товара из города $j$ по цене города $i$. Например, если возьмем первый город с ценами $(4, 3, 10)$ и объем для него $(5, 0, 5)$, то получим, что стоимость будет 70.

 А вот если бы мы продавали объем из первого города $(5, 0, 5)$ во втором $(5, 4, 11)$, то стоимость уже 80.

Нам для ответа нужны только те элементы матрицы, у которых номер города совпадает с номером объема, то есть где индексы $i=j$. Это условие выполняется на главной диагонали матрицы (элементы 70 и 57). Соответственно, нужно взять эти элементы и сложить.

Операция взятия суммы главной диагонали также называется **следом матрицы** и обозначается $tr A$ или $Sp A$.

Конечно же, можно заметить, что нам совсем необязательно считать произведение матриц для того, чтобы получить ответ в этой задаче.

Можно пойти другим путем и исходные матрицы поэлеметно умножить друг на друга. Назовем такую матрицу $D$:

$$
D = A \otimes B =
\begin{bmatrix}
20 & 0 & 50 \\
20 & 4 & 33
\end{bmatrix}
$$

В каждой ячейке такой матрицы будет находиться сумма, которую можно заработать, если реализовать весь товар в этом городе. Далее нам нужно произвести суммирование по каждой строке и получить тот же ответ.
