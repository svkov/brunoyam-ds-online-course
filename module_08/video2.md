# Задачи на теорему Байеса

Теорема Байеса позволяет уточнять вероятность события, основываясь на информации, которую мы получаем из эксперимента.

Давайте рассмотрим пример задачи на теорему Байеса.

## Задача 1

Среди определенной группы людей вероятность заболеть коронавирусом 0.1. Тест позволяет выявить болезнь с вероятностью 0.98 на больных людях, но также он дает ложно-положительный результат с вероятностью 0.01. Найдите вероятность того, что человек, сдавший тест, действительно болен.

## Решение 1

Пусть событие $A$ - человек болен, а событие $B$ - тест дал положительный результат.

Дано:

$P(A) = 0.1$

$P(B|A)=0.98$

$P(B|\bar{A})=0.01$

Нужно найти $P(A|B)$

Вспомним формулу Байеса:

$$P(A|B) = \frac{P(B|A) P(A)}{{(B)}}$$

Чтобы получить ответ нам необходимо узнать $P(B)$, которое можно посчитать по формуле полной вероятности:

$$P(B) = P(B|A)P(A) + P(B|\bar{A})P(\bar{A})$$

Посчитаем $P(B)$:

$$P(B) = 0.98 * 0.1 + 0.01 * 0.9 = 0.107$$

И подставим значения в формулу Байеса:

$$P(A|B) = \frac{0.98 * 0.1}{0.107} = 0.916$$

Как видим, результат значительно ниже 98%, которые гарантирует тест.

## Задача 2

Используя условия прошлой задачи найдите вероятность того, что класс из 30 человек закроют на карантин. Класс закрывают на карантин, если тест дает положительный результат хотя бы на 5 школьниках.

## Решение 2

Здесь мы имеем дело с биномиальным распределением. С вероятностью $p=P(B)$ тест даст положительный результат. Мы не знаем сколько человек в классе болеет, поэтому будем использовать полную вероятность B.

Также мы знаем, что $n=30$, и нам нужно найти вероятность того, что тест даст положительный результат на 5 или более людях.

Вспомним формулу вероятности для биномиального распределения:

$$P(X=k) = C_n^k p^k q^{n-k}$$

Нужная нам вероятность - $P(5 \leq X \leq 30)$

Проще всего сначала посчитать $P(X < 5)$, а затем вычесть из единицы.

Напишем небольшую программу, чтобы не считать вручную.

```python
from scipy.special import binom

def p_k(p, q, n, k):
    return binom(n, k) * (p ** k) * (q ** (n-k))

p = 0.107
q = 1 - p
n = 30

p_x = 0
for k in range(5):
    p_x += p_k(p, q, n, k)

p_x = 1 - p_x

print(p_x) # 0.21
```

Итого получили, что 21% классов закроют на карантин.
