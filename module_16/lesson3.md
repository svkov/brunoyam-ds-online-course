# Docker

## Введение

Что теперь может помешать воспроизводимости? На самом деле, все еще много чего - операционная система, версии библиотек, стабильность интернет-соединения и т.д. Вы не можете знать в каких условиях будет запускаться ваш код. Или можем?

Docker - ПО, которое позволяет создавать унифицированные контейнеры для приложений. Если приложение завернуто в docker, то оно будет одинаково запускаться на любой операционной системе, для которой реализован docker. Создатель такого контейнера прописывает версию ОС, версию python (или другого языка программирования), какие библиотеки нужно установить и прочее. Затем другой разработчик чтобы развернуть у себя это же решение, просто формирует этот же контейнер по тем же правилам и получает такую же среду. Если из докер-контейнера запускать конвейеры по обработке данных, то результаты будут полностью воспроизводимы.

Docker позволяет унифицировать приложения до простой абстракции в виде контейнера. Запустить докер-контейнер проще, чем устанавливать приложение самостоятельно. Нужно просто скачать код из репозитория и запустить образ, остальное докер сделает сам.

Чтобы лучше понять зачем нужен докер, можно обратиться к истории. Раньше когда груз перевозили на кораблях, то большую часть времени занимала погрузка и разгрузка корабля. Нужно было перетащить на корабль много разного груза, для этого нужно было много человек. Все изменилось, когда люди придумали складывать весь груз в унифицированные контейнеры. Это можно делать даже когда корабль еще плавает, и контейнеры достаточно большие, чтобы туда поместилось все, что нужно. После наполнения контейнер ожидает свой корабль, а затем легким движением крана он оказывается на борту корабля. Таким образом скорость погрузки и разгрузки кораблей увеличилась в сотни раз и общая логистика в мире ускорилась. Докер позволяет делать тоже самое, только с программами. Любой, у кого есть докер, может запустить любой доступный контейнер, не задумываясь над тем, как оно на самом деле работает.

Docker чаще всего используется для развертки веб-приложений на кластерах, когда нужно на множестве машин запустить один и тот же код. Вместо того, чтобы на каждой машине отдельно настраивать приложение, пишется скрипт, который по очереди подключается к каждой машине и запускает докер-контейнер. Это проще и эффективнее. Data Scientist-ы точно также разворачивают свои решения на кластерах (также этим занимаются Data Engineer-ы), а значит исследования точно также можно положить в докер.

## Терминология

Как мы уже выяснили, для приложения создается контейнер. **Контейнер** - это изолированная среда внутри компьютера, похожая на виртуальную машину, но не являющаяся ею. Все файлы, создаваемые внутри контейнера, не попадают в основную операционную систему и удалятся при остановке контейнера. Чтобы построить контейнер, нам нужен его образ. **Образ контейнера** (image) - это набор команд, который позволяет создать необходимый контейнер. Чаще всего образ контейнера задается при помощи Dokerfile-а, в котором поочередно указывается какие команды необходимо выполнить, чтобы создать контейнер.

Образ контейнера состоит из **слоев**. Каждая новая примененная команда, будет создавать уже новый образ, поэтому применение новой команды создает новый слой. Например, сначала мы установили операционную систему, затем установили python, и создали папку для нашего проекта. Три операции = три слоя. После каждого примененного слоя докер может посчитать номер (хэш) этого образа и сохранить его. Благодаря этому можно не делать лишних операций.

Допустим, мы сделали три слоя, и для каждого посчитали хэш:

1. Установка ОС (хэш = 1)
2. Установка python (хэш = 2)
3. Создание папки для проекта (хэш = 3)

А затем мы изменили третий шаг:

1. Установка ОС (хэш = 1)
2. Установка python (хэш = 2)
3. Установка зависимостей проекта (хэш = 4)

Теперь докер увидит, что хэш на последнем шаге поменялся. Но вместо того, чтобы заново запускать всю последовательность, он возьмет копию, сохраненную после второго шага, и для нее запустит новую команду. Это позволяет здорово экономить время.

Образ необходимо собрать (build), чтобы из него получился контейнер.

Теперь можно приступать к практической части, где вы узнаете как установить Docker и как им пользоваться.
